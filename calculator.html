<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>冬キャンプ試算表 (2025-01版)</title>
  <style>
    :root {
      --primary: #2c5282;
      --secondary: #4299e1;
      --accent: #ed8936;
      --bg: #f7fafc;
      --surface: #ffffff;
      --text-main: #2d3748;
      --text-sub: #718096;
      --border: #e2e8f0;
    }

    body {
      font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
      background-color: var(--bg);
      color: var(--text-main);
      line-height: 1.6;
      margin: 0;
      padding: 20px;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      background: var(--surface);
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    }

    h1 {
      color: var(--primary);
      text-align: center;
      margin-bottom: 30px;
      font-size: 1.8rem;
      border-bottom: 2px solid var(--border);
      padding-bottom: 15px;
    }

    h2 {
      font-size: 1.25rem;
      color: var(--primary);
      margin-top: 30px;
      margin-bottom: 15px;
      padding-left: 10px;
      border-left: 5px solid var(--secondary);
    }

    h3 {
      font-size: 1.1rem;
      color: var(--text-main);
      margin-top: 20px;
      font-weight: 600;
    }

    .section {
      margin-bottom: 25px;
      padding: 20px;
      background: #f8fbff;
      border-radius: 8px;
      border: 1px solid var(--border);
    }

    .control-group {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    .control-group label {
      flex: 1;
      min-width: 200px;
      font-weight: 500;
    }

    .input-wrapper {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    input[type="number"] {
      width: 80px;
      padding: 8px;
      border: 1px solid #cbd5e0;
      border-radius: 6px;
      text-align: right;
      font-size: 1rem;
    }

    .unit {
      color: var(--text-sub);
      font-size: 0.9rem;
      width: 40px;
    }

    .checkbox-wrapper {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 5px;
    }

    .summary-box {
      position: sticky;
      bottom: 20px;
      background: var(--primary);
      color: white;
      padding: 20px;
      border-radius: 10px;
      margin-top: 40px;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2);
      z-index: 100;
    }

    .summary-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      font-size: 0.95rem;
    }

    .summary-total {
      border-top: 1px solid rgba(255, 255, 255, 0.3);
      margin-top: 10px;
      padding-top: 10px;
      font-size: 1.5rem;
      font-weight: bold;
      text-align: right;
    }

    .category-total {
      font-weight: bold;
      color: var(--secondary);
      text-align: right;
      margin-bottom: 10px;
    }

    /* Items Grid */
    .items-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 15px;
    }

    .item-card {
      background: white;
      padding: 15px;
      border-radius: 6px;
      border: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .item-header {
      display: flex;
      justify-content: space-between;
      font-size: 0.95rem;
      font-weight: bold;
    }

    .item-price {
      font-size: 0.85rem;
      color: var(--text-sub);
    }

    .btn-helper {
      background: #edf2f7;
      border: none;
      color: var(--text-sub);
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.75rem;
      cursor: pointer;
      transition: background 0.2s;
    }

    .btn-helper:hover {
      background: #e2e8f0;
      color: var(--text-main);
    }

    .item-subtotal {
      text-align: right;
      font-weight: bold;
      color: var(--primary);
      font-size: 0.9rem;
      margin-top: 5px;
      border-top: 1px dashed #e2e8f0;
      padding-top: 5px;
    }

    .price-info {
      font-weight: normal;
      font-size: 0.85rem;
      color: var(--text-sub);
      margin-left: 8px;
    }

    button.toggle-btn {
      background: none;
      border: none;
      color: var(--secondary);
      cursor: pointer;
      text-align: left;
      padding: 0;
      font-size: 1rem;
      text-decoration: underline;
    }

    .hidden {
      display: none;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .control-group {
        flex-direction: column;
        align-items: stretch;
        gap: 5px;
      }

      .input-wrapper {
        justify-content: flex-end;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>冬キャンプ試算表 (2025-01版)</h1>

    <!-- 1. 参加人数 -->
    <div class="section">
      <h2>1. 参加人数・日程</h2>
      <div class="control-group">
        <label>小学生以下 (Elementary)<span id="price_elem" class="price-info"></span></label>
        <div class="input-wrapper">
          <input type="number" id="count_elem" value="0" min="0">
          <span class="unit">名</span>
        </div>
      </div>
      <div class="control-group">
        <label>中学生 (Junior HS)<span id="price_jhs" class="price-info"></span></label>
        <div class="input-wrapper">
          <input type="number" id="count_jhs" value="0" min="0">
          <span class="unit">名</span>
        </div>
      </div>
      <div class="control-group">
        <label>高校生 (High School)<span id="price_hs" class="price-info"></span></label>
        <div class="input-wrapper">
          <input type="number" id="count_hs" value="0" min="0">
          <span class="unit">名</span>
        </div>
      </div>
      <div class="control-group">
        <div>
          <label>大人・その他 (Adults)<span id="price_adult" class="price-info"></span></label>
          <div id="adult_breakdown" style="margin-top:2px;"></div>
        </div>
        <div class="input-wrapper">
          <input type="number" id="count_adult" value="0" min="0">
          <span class="unit">名</span>
        </div>
      </div>
      <hr style="margin: 15px 0; border: 0; border-top: 1px solid var(--border);">
      <div class="control-group">
        <label>施設利用 (Facility)</label>
        <div class="input-wrapper" style="gap: 20px;">
          <label style="min-width:auto; font-weight:normal;"><input type="radio" name="facility_type" value="main"
              checked> 宿泊棟</label>
          <label style="min-width:auto; font-weight:normal;"><input type="radio" name="facility_type" value="camp">
            キャンプ場</label>
        </div>
      </div>
      <div class="control-group">
        <label>日帰り利用日数 (Day Use)</label>
        <div class="input-wrapper">
          <input type="number" id="days_dayuse" value="0" min="0">
          <span class="unit">日</span>
        </div>
      </div>
      <div class="control-group">
        <label>宿泊数 (Nights)</label>
        <div class="input-wrapper">
          <input type="number" id="nights" value="1" min="0">
          <span class="unit">泊</span>
        </div>
      </div>
      <div id="facility_total" class="category-total">施設料計: 0円</div>
    </div>

    <!-- 2. シーツ・リネン -->
    <div class="section">
      <h2>2. リネン・寝具</h2>
      <div id="linen_container" class="items-grid"></div>
      <div id="linen_total" class="category-total">リネン計: 0円</div>
    </div>

    <!-- 3. 食事 -->
    <div class="section">
      <h2>3. 食事 (Meals)</h2>
      <h3>食堂メニュー</h3>
      <div id="meals_std_container" class="items-grid"></div>
      <h3>お弁当・野外炊事</h3>
      <div id="meals_other_container" class="items-grid"></div>
      <h3>飲み物・氷</h3>
      <div id="drinks_container" class="items-grid"></div>
      <div id="food_total" class="category-total">食事計: 0円</div>
    </div>

    <!-- 4. 販売・レンタル -->
    <div class="section">
      <h2>4. 販売・レンタル物品</h2>
      <button class="toggle-btn" onclick="toggleSection('sales_content')">▼ 販売品・クラフト (消耗品・薪・炭など)</button>
      <div id="sales_content" class="items-grid hidden" style="margin-top:10px;"></div>

      <br><br>
      <button class="toggle-btn" onclick="toggleSection('rental_content')">▼ 一般レンタル (シュラフ・調理器具など)</button>
      <div id="rental_content" class="items-grid hidden" style="margin-top:10px;"></div>

      <br><br>
      <button class="toggle-btn" onclick="toggleSection('winter_content')">▼ 冬季レンタル (スキー・ウェア)</button>
      <div id="winter_content" class="items-grid hidden" style="margin-top:10px;"></div>

      <div style="margin-top:20px;" id="goods_total" class="category-total">物品計: 0円</div>
    </div>

    <!-- 合計 -->
    <div class="summary-box">
      <div class="summary-row">
        <span>施設利用料</span>
        <span id="sum_facility">0円</span>
      </div>
      <div class="summary-row">
        <span>リネン・寝具</span>
        <span id="sum_linen">0円</span>
      </div>
      <div class="summary-row">
        <span>食事・食料</span>
        <span id="sum_food">0円</span>
      </div>
      <div class="summary-row">
        <span>販売・レンタル</span>
        <span id="sum_goods">0円</span>
      </div>
      <div class="summary-total">
        合計: <span id="grand_total">0</span>円
      </div>
      <div style="text-align:right; font-size:0.8rem; margin-top:5px; opacity:0.8;">※試算額は目安です</div>
    </div>
  </div>

  <script>
    // --- Data Definition ---
    const PRICING = {
      facility: {
        youth: { // 18歳未満、高校生、引率者
          main: { day: 150, night: 300 },
          camp: { day: 50, night: 70 }
        },
        adult: { // その他
          main: { day: 300, night: 600 },
          camp: { day: 70, night: 200 }
        }
      },
      linen: [
        { id: 'sheets_main', label: 'シーツ代(宿泊棟必須)', price: 350, unit: '枚' },
        { id: 'sleeping_bag', label: 'シュラフ(寝袋)', price: 200, unit: '泊' },
        { id: 'sleeping_bag_sheet', label: 'シュラフ用シーツ', price: 350, unit: '枚' },
        { id: 'camp_mat', label: 'キャンプマット', price: 100, unit: '泊' },
        { id: 'blanket', label: '毛布', price: 0, unit: '枚' }
      ],
      meals_std: [
        { id: 'bk', label: '朝食', price: 700 },
        { id: 'lc', label: '昼食', price: 800 },
        { id: 'dn', label: '夕食', price: 1000 },
        { id: 'dn_vol', label: '夕食(増量)', price: 1200 },
      ],
      meals_other: [
        { id: 'bento_daily', label: 'てんかむてき弁当(日替り)', price: 800 },
        { id: 'bento_mt', label: '登山弁当', price: 700 },
        { id: 'ramen_change', label: '夕食→ラーメン定食変更', price: 1200 },
        { id: 'curry_ing', label: 'カレー材料(米なし)', price: 400 },
        { id: 'rice', label: '米(1合)', price: 120, unit: '合' },
        { id: 'yakisoba', label: '焼きそば材料', price: 400 },
        { id: 'pork_soup', label: '豚汁材料', price: 400 },
        { id: 'carton_dog', label: 'カートンドッグ材料', price: 400 },
      ],
      drinks: [
        { id: 'sp_500', label: 'スポーツドリンク(500ml)', price: 150, unit: '本' },
        { id: 'sp_2l', label: 'スポーツドリンク(2L)', price: 250, unit: '本' },
        { id: 'tea_500', label: 'お茶(500ml)', price: 150, unit: '本' },
        { id: 'tea_2l', label: 'お茶(2L)', price: 250, unit: '本' },
        { id: 'ice', label: '板氷1.7kg(かちわり2kg)', price: 300, unit: '個' },
      ],
      sales: [
        { id: 'trash_burn', label: 'ごみ袋(燃やすごみ用)', price: 50, unit: '枚' },
        { id: 'trash_pet', label: 'ごみ袋(ペット/カン/ビン)', price: 15, unit: '枚' },
        { id: 'wood_con', label: '薪(針葉樹)', price: 450, unit: '束' },
        { id: 'wood_bro', label: '薪(広葉樹)', price: 650, unit: '束' },
        { id: 'charcoal', label: 'バーベキュー用炭(6kg)', price: 1400, unit: '箱' },
        { id: 'kerosene', label: '灯油', price: 160, unit: 'L' },
        { id: 'torch', label: 'トーチ棒', price: 200, unit: '本' },
        { id: 'lime', label: 'グラウンド用石灰(20kg)', price: 1100, unit: '袋' },
        { id: 'cedar_raw', label: '杉板(焼いてない)', price: 110, unit: '枚' },
        { id: 'cedar_burn', label: '杉板(焼いた)', price: 180, unit: '枚' },
        { id: 'pendant', label: '木のペンダント', price: 100, unit: '個' },
        { id: 'spoon', label: '枝のスプーン', price: 220, unit: '個' },
        { id: 'postcard', label: '木のはがき', price: 140, unit: '枚' },
        { id: 'wood_slice', label: '木の輪切り(3枚セット)', price: 150, unit: '組' },
      ],
      rentals: [
        { id: 'iron_plate', label: '鉄板(フライ返し・トング付)', price: 250, unit: '日' },
        { id: 'bbq_set', label: 'BBQグリルセット', price: 1100, unit: '泊' },
        { id: 'campfire', label: 'キャンプファイヤー井桁', price: 3500, unit: '組', note: '職員組: +2000円' },
        { id: 'fire_start', label: '火起こし器セット', price: 500, unit: '日' },
        { id: 'pole', label: 'ノルディックウォーキングポール', price: 250, unit: '日' },
        { id: 'golf', label: 'グラウンドゴルフセット', price: 150, unit: '日' },
        { id: 'soccer', label: 'サッカーゴール(ネット)', price: 2000, unit: '対' },
        { id: 'table_tennis', label: '卓球台', price: 1000, unit: '日' },
        { id: 'badminton', label: 'バドミントンネットセット', price: 1000, unit: '日' },
        { id: 'tent', label: 'ドーム型テント(4~5人用)', price: 2000, unit: '泊' },
      ],
      winter: [
        { id: 'boots', label: '長ぐつ', price: 350, unit: '日' },
        { id: 'snowshoes', label: 'スノーシュー', price: 300, unit: '日' },
        { id: 'sled', label: 'そり', price: 500, unit: '日' },
        { id: 'wear_elem', label: 'ウェア(小学生以下) 1日', price: 2000, note: "2日:2700, 3日:3600" },
        { id: 'wear_adult', label: 'ウェア(中学生以上) 1日', price: 2400, note: "2日:3000, 3日:3800" },
      ]
      // Note: Simplified multi-day logic to x1 quantity.
    };

    // --- State Management ---
    const state = {
      people: { elem: 0, jhs: 0, hs: 0, adult: 0 },
      adultsAreLeaders: false,
      facility: { type: 'main', days: 0, nights: 1 },
      items: {} // id -> count
    };

    function init() {
      // Special render for Linen (Sheets) - Read Only display
      renderLinenSection();

      // Special render for Meals - Input is "Times"
      renderMealsStdSection();

      renderItems('meals_other_container', PRICING.meals_other);
      renderItems('drinks_container', PRICING.drinks);
      renderItems('sales_content', PRICING.sales);
      renderItems('rental_content', PRICING.rentals);
      renderItems('winter_content', PRICING.winter);

      // Listeners
      document.querySelectorAll('input').forEach(el => {
        el.addEventListener('input', updateState);
        el.addEventListener('change', updateState);
      });
    }

    function renderLinenSection() {
      const container = document.getElementById('linen_container');
      container.innerHTML = '';

      PRICING.linen.forEach(item => {
        state.items[item.id] = 0;
        const isSheets = item.id === 'sheets_main';

        const div = document.createElement('div');
        div.className = 'item-card';
        div.style.background = isSheets ? '#f0fff4' : 'white'; // Highlight mandatory

        const unit = item.unit || '個(食)';

        let controlHtml = '';
        if (isSheets) {
          // Read-only info
          controlHtml = `
                    <div style="text-align:right; font-size:0.9rem; color:var(--primary); font-weight:bold;">
                        宿泊人数分 (必須)
                        <input type="hidden" id="item_${item.id}" data-id="${item.id}" value="0">
                        <span id="disp_${item.id}">0</span> 枚
                    </div>
                `;
        } else {
          // Normal input
          controlHtml = `
                    <div class="control-group" style="margin-bottom:0; justify-content:flex-end; gap:10px;">
                        <button class="btn-helper" onclick="setCount('${item.id}', 'total')">全員</button>
                        <div class="input-wrapper">
                            <input type="number" id="item_${item.id}" data-id="${item.id}" value="0" min="0" style="width:60px;">
                        </div>
                    </div>
                `;
        }

        div.innerHTML = `
                <div class="item-header">
                    <span>${item.label}</span>
                </div>
                <div class="item-price">${item.price}円 / ${unit}</div>
                ${controlHtml}
                <div id="subtotal_${item.id}" class="item-subtotal">0円</div>
            `;
        container.appendChild(div);
      });
    }

    function renderMealsStdSection() {
      const container = document.getElementById('meals_std_container');
      PRICING.meals_std.forEach(item => {
        state.items[item.id] = 0;

        const div = document.createElement('div');
        div.className = 'item-card';

        div.innerHTML = `
                <div class="item-header">
                    <span>${item.label}</span>
                </div>
                <div class="item-price">${item.price}円 / 食 (人数分自動計算)</div>
                <div class="control-group" style="margin-bottom:0; justify-content:flex-end; gap:10px;">
                    <label style="min-width:auto; font-size:0.8rem; text-align:right;">回数:</label>
                    <div class="input-wrapper">
                        <input type="number" id="item_${item.id}" data-id="${item.id}" data-type="meal_times" value="0" min="0" style="width:50px;">
                        <span class="unit">回</span>
                    </div>
                </div>
                <div id="subtotal_${item.id}" class="item-subtotal">0円</div>
            `;
        container.appendChild(div);
      });
    }

    function renderItems(containerId, items) {
      const container = document.getElementById(containerId);
      items.forEach(item => {
        state.items[item.id] = 0; // init state

        const div = document.createElement('div');
        div.className = 'item-card';

        const unit = item.unit || '個(食)';
        const note = item.note ? `<br><small style="color:#e53e3e">${item.note}</small>` : '';

        div.innerHTML = `
                <div class="item-header">
                    <span>${item.label}</span>
                </div>
                <div class="item-price">${item.price}円 / ${unit} ${note}</div>
                <div class="control-group" style="margin-bottom:0; justify-content:flex-end; gap:10px;">
                    <div style="display:flex; gap:5px;">
                        <button class="btn-helper" onclick="setCount('${item.id}', 'total')">全員</button>
                    </div>
                    <div class="input-wrapper">
                        <input type="number" id="item_${item.id}" data-id="${item.id}" value="0" min="0" style="width:60px;">
                    </div>
                </div>
                <div id="subtotal_${item.id}" class="item-subtotal">0円</div>
            `;
        container.appendChild(div);
      });
    }

    function toggleSection(id) {
      const el = document.getElementById(id);
      el.classList.toggle('hidden');
    }

    window.setCount = function (itemId, mode) {
      const totalPeople = state.people.elem + state.people.jhs + state.people.hs + state.people.adult;
      const targetInput = document.getElementById(`item_${itemId}`);
      if (mode === 'total') {
        targetInput.value = totalPeople;
      }
      updateState();
    }

    function updateState() {
      // Read Inputs
      state.people.elem = parseInt(document.getElementById('count_elem').value) || 0;
      state.people.jhs = parseInt(document.getElementById('count_jhs').value) || 0;
      state.people.hs = parseInt(document.getElementById('count_hs').value) || 0;
      state.people.adult = parseInt(document.getElementById('count_adult').value) || 0;
      // state.adultsAreLeaders removed

      const facTypeEls = document.getElementsByName('facility_type');
      state.facility.type = facTypeEls[0].checked ? 'main' : 'camp';
      state.facility.days = parseInt(document.getElementById('days_dayuse').value) || 0;
      state.facility.nights = parseInt(document.getElementById('nights').value) || 0;

      const totalPeople = state.people.elem + state.people.jhs + state.people.hs + state.people.adult;

      // Update Unit Prices Display
      updateUnitPrices();

      // Update Discount Info Display
      updateDiscountDisplay();

      // Auto-update Sheets count (visible 0 if Camp)
      // Sheets are only mandatory if Facility Type is "Main Building" AND Nights > 0?
      // User said "Mandatory for all staying guests".
      // Assuming if they stay at Main Building, they need sheets. If Campsite, maybe not (sleeping bag?).
      // Pricing table: "シーツ代（宿泊棟利用時は必須）" -> "Mandatory when using Main Building".

      const sheetsEl = document.getElementById('item_sheets_main');
      const sheetsDisp = document.getElementById('disp_sheets_main');

      let sheetsCount = 0;
      if (state.facility.type === 'main' && state.facility.nights > 0) {
        sheetsCount = totalPeople;
      }
      if (sheetsEl) {
        sheetsEl.value = sheetsCount;
        sheetsDisp.textContent = sheetsCount;
      }

      // Read Item Counts
      document.querySelectorAll('input[id^="item_"]').forEach(input => {
        const id = input.dataset.id;
        const val = parseInt(input.value) || 0;

        if (input.dataset.type === 'meal_times') {
          // Store Times * People in state? Or just store Times and calculate later?
          // Let's store the "Billing Quantity" in state.items for consistency with calc logic.
          // Billing Qty = Times * TotalPeople
          state.items[id] = val * totalPeople;
        } else {
          state.items[id] = val;
        }
      });

      calculate();
    }

    function updateDiscountDisplay() {
      // Calculate Discounted Adults
      const youthCount = state.people.elem + state.people.jhs + state.people.hs;
      const maxDiscountedAdults = Math.ceil(youthCount * 0.2);
      const actualDiscountedAdults = Math.min(state.people.adult, maxDiscountedAdults);
      const normalAdults = state.people.adult - actualDiscountedAdults;

      const dispEl = document.getElementById('adult_breakdown');
      if (dispEl) {
        if (state.people.adult > 0) {
          dispEl.innerHTML = `<span style="color:var(--secondary); font-size:0.9rem;">(引率割引: ${actualDiscountedAdults}名, 一般: ${normalAdults}名)</span>`;
        } else {
          dispEl.innerHTML = `<span style="color:var(--text-sub); font-size:0.8rem;">(高校生以下の20%[切上]まで引率割引)</span>`;
        }
      }
    }

    function updateUnitPrices() {
      const type = state.facility.type; // 'main' or 'camp'
      const youthConf = PRICING.facility.youth[type];
      const adultConf = PRICING.facility.adult[type];

      const youthText = `(@日${youthConf.day}/泊${youthConf.night})`;
      const adultText = `(@日${adultConf.day}/泊${adultConf.night})`;

      const setPrice = (id, text) => {
        const el = document.getElementById(id);
        if (el) el.textContent = text;
      }

      setPrice('price_elem', youthText);
      setPrice('price_jhs', youthText);
      setPrice('price_hs', youthText);
      setPrice('price_adult', adultText);
    }

    function calculate() {
      // 1. Facility Fees
      const youthCount = state.people.elem + state.people.jhs + state.people.hs;

      // 20% Rule
      const maxDiscountedAdults = Math.ceil(youthCount * 0.2);
      const discountedAdults = Math.min(state.people.adult, maxDiscountedAdults);
      const normalAdults = state.people.adult - discountedAdults;

      const effectiveYouth = youthCount + discountedAdults;
      const effectiveAdult = normalAdults;

      const feeConfig = PRICING.facility;
      // Youth Rates
      const y_day = feeConfig.youth[state.facility.type].day * state.facility.days;
      const y_night = feeConfig.youth[state.facility.type].night * state.facility.nights;
      const youthFee = (y_day + y_night) * effectiveYouth;

      // Adult Rates
      const a_day = feeConfig.adult[state.facility.type].day * state.facility.days;
      const a_night = feeConfig.adult[state.facility.type].night * state.facility.nights;
      const adultFee = (a_day + a_night) * effectiveAdult;

      const totalFacility = youthFee + adultFee;

      // 2. Items Calculation
      let totalLinen = 0;
      let totalFood = 0;
      let totalGoods = 0;

      const calcCategory = (list) => {
        let subTotal = 0;
        list.forEach(item => {
          const count = state.items[item.id] || 0;
          const cost = item.price * count;
          subTotal += cost;

          // Update Subtotal UI
          const subEl = document.getElementById(`subtotal_${item.id}`);
          if (subEl) {
            subEl.textContent = `${cost.toLocaleString()}円`;
          }
        });
        return subTotal;
      };

      totalLinen = calcCategory(PRICING.linen);

      totalFood += calcCategory(PRICING.meals_std);
      totalFood += calcCategory(PRICING.meals_other);
      totalFood += calcCategory(PRICING.drinks);

      totalGoods += calcCategory(PRICING.sales);
      totalGoods += calcCategory(PRICING.rentals);
      totalGoods += calcCategory(PRICING.winter);

      // Update UI
      document.getElementById('facility_total').textContent = `施設料計: ${totalFacility.toLocaleString()}円`;
      document.getElementById('linen_total').textContent = `リネン計: ${totalLinen.toLocaleString()}円`;
      document.getElementById('food_total').textContent = `食事計: ${totalFood.toLocaleString()}円`;
      document.getElementById('goods_total').textContent = `物品計: ${totalGoods.toLocaleString()}円`;

      document.getElementById('sum_facility').textContent = `${totalFacility.toLocaleString()}円`;
      document.getElementById('sum_linen').textContent = `${totalLinen.toLocaleString()}円`;
      document.getElementById('sum_food').textContent = `${totalFood.toLocaleString()}円`;
      document.getElementById('sum_goods').textContent = `${totalGoods.toLocaleString()}円`;

      const grandTotal = totalFacility + totalLinen + totalFood + totalGoods;
      document.getElementById('grand_total').textContent = grandTotal.toLocaleString();
    }

    // Initialize
    window.addEventListener('DOMContentLoaded', init);

  </script>
</body>

</html>